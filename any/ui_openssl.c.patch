--- a/crypto/ui/ui_openssl.c	2018-08-15 16:30:58.000000000 +0800
+++ b/crypto/ui/ui_openssl.c	2018-08-15 16:26:31.000000000 +0800
@@ -301,6 +301,15 @@
 #endif
 static FILE *tty_in, *tty_out;
 static int is_a_tty;
+#ifdef OPENSSL_SYS_PASE
+int Qp0zIsATerminal(int fd);
+int Qp0zSetTerminalMode(unsigned char mode,
+                        unsigned char type);
+#define QP0Z_TERMINAL_INPUT_MODE  0x01
+#define QP0Z_TERMINAL_HIDDEN      0xBD
+#define QP0Z_TERMINAL_NORMAL      0xBE
+static int is_a_5250;
+#endif
 
 /* Declare static functions */
 #if !defined(OPENSSL_SYS_WIN16) && !defined(OPENSSL_SYS_WINCE)
@@ -493,6 +502,13 @@
         tty_out = stderr;
 #endif
 
+#if defined(OPENSSL_SYS_PASE)
+    if (Qp0zIsATerminal(fileno(tty_in)) == 1) {
+        is_a_tty = 0;
+        is_a_5250 = 1;
+        return 1;
+    }
+#endif
 #if defined(TTY_get) && !defined(OPENSSL_SYS_VMS)
     if (TTY_get(fileno(tty_in), &tty_orig) == -1) {
 # ifdef ENOTTY
@@ -545,6 +561,12 @@
     tty_new.TTY_FLAGS &= ~ECHO;
 #endif
 
+#if defined(OPENSSL_SYS_PASE)
+    if ( is_a_5250 && Qp0zSetTerminalMode(QP0Z_TERMINAL_INPUT_MODE,
+                                          QP0Z_TERMINAL_HIDDEN)) {
+        return 0;
+    }
+#endif
 #if defined(TTY_set) && !defined(OPENSSL_SYS_VMS)
     if (is_a_tty && (TTY_set(fileno(tty_in), &tty_new) == -1))
         return 0;
@@ -567,6 +589,12 @@
 {
 #if defined(TTY_set) && !defined(OPENSSL_SYS_VMS)
     memcpy(&(tty_new), &(tty_orig), sizeof(tty_orig));
+#if defined(OPENSSL_SYS_PASE)
+    if ( is_a_5250 && Qp0zSetTerminalMode(QP0Z_TERMINAL_INPUT_MODE,
+                                          QP0Z_TERMINAL_NORMAL)) {
+        return 0;
+    }
+#endif
     if (is_a_tty && (TTY_set(fileno(tty_in), &tty_new) == -1))
         return 0;
 #endif
